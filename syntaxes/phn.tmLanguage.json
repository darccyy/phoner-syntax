{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Phonotactic",

  "patterns": [
    {
      "include": "#comments"
    },
    {
      "include": "#classes"
    },
    {
      "include": "#patterns"
    },
    {
      "include": "#reasons"
    },
    {
      "include": "#tests"
    }
  ],

  "repository": {
    "comments": {
      "name": "comment.line.phn",
      "begin": "#",
      "end": "\n"
    },

    "classes": {
      "begin": "\\$[A-Z]",
      "end": "\n",
      "beginCaptures": {
        "0": { "name": "entity.name.type.class.phn" }
      },
      "patterns": [
        {
          "include": "#regex"
        }
      ]
    },

    "patterns": {
      "begin": "&",
      "end": "\n",
      "beginCaptures": { "0": { "name": "keyword.operator.pattern.phn" } },
      "patterns": [{ "include": "#regex" }, { "include": "#bang" }]
    },

    "reasons": {
      "name": "string.reason.phn",
      "begin": "@",
      "end": "\n",
      "beginCaptures": { "0": { "name": "keyword.operator.reason.phn" } }
    },

    "tests": {
      "name": "variable.literal.phn",
      "begin": "\\*",
      "end": "\n",
      "beginCaptures": { "0": { "name": "keyword.other.phn" } },
      "patterns": [{ "include": "#bang" }]
    },

    "bang": {
      "patterns": [
        {
          "name": "variable.language.self.phn",
          "match": "!"
        }
      ]
    },

    "regex": {
      "patterns": [
        {
          "begin": "\\(",
          "end": "\\)",
          "beginCaptures": { "0": { "name": "punctuation.brackets.phn" } },
          "endCaptures": { "0": { "name": "punctuation.brackets.phn" } },
          "patterns": [{ "include": "#regex" }]
        },
        {
          "name": "keyword.operator.phn",
          "match": "[\\[\\]\\?|\\|\\+\\*\\.]"
        },
        {
          "name": "keyword.other.phn",
          "match": "[\\^\\$]"
        },
        {
          "name": "keyword.operator.phn",
          "begin": "\\{",
          "end": "\\}",
          "match": "\\{\\d\\}"
        },
        {
          "name": "entity.name.type.phn",
          "match": "[A-Z]"
        },
        {
          "name": "variable.literal.phn",
          "match": "[A-Z]"
        }
      ]
    }
  },
  "scopeName": "source.phn"
}
